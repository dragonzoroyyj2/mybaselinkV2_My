<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default_layout}">

<head>
  <meta charset="UTF-8">
  <title>ì‚¬ìš©ì ê´€ë¦¬</title>
</head>

<body>
<div layout:fragment="content">
  <div class="content-container">
		<div class="page-header">
		  <div class="page-title">
		    <h2 th:text="${pageTitle} ?: 'ğŸ“„ ê¸°ë³¸ í˜ì´ì§€ ì œëª©'">ğŸ“„ ê¸°ë³¸ í˜ì´ì§€ ì œëª©</h2>
		  </div>
		  <div class="breadcrumb">
		    <i class="fas fa-folder-open"></i>
		    <span th:text="${breadcrumb} ?: 'ì‹œìŠ¤í…œ / ê¸°ë³¸ ê²½ë¡œ'">ì‹œìŠ¤í…œ / ê¸°ë³¸ ê²½ë¡œ</span>
		  </div>
		</div>    

    <!-- ğŸ” ê²€ìƒ‰ íˆ´ë°” -->
    <div class="toolbar">
      <div class="search-group">
        <input type="text" id="searchInput" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" />
        <button id="searchBtn" class="btn"><i class="fas fa-search"></i></button>
        <button class="btn"><i class="fas fa-filter"></i></button>
        <button class="btn"><i class="fas fa-sync-alt"></i></button>
      </div>
    </div>

    <!-- ğŸ“Š ë¦¬ìŠ¤íŠ¸ ì •ë³´ + ë²„íŠ¼ -->
    <div class="list-info">
      <span id="totalCount">ì´ 0ê±´</span>
      <div class="action-buttons">
        <button id="excelBtn" class="btn excel" title="ì—‘ì…€ ë‹¤ìš´ë¡œë“œ"><i class="fa-solid fa-file-excel"></i></button>
        <button id="addBtn" class="btn" title="ì¶”ê°€"><i class="fas fa-plus"></i></button>
        <button id="deleteSelectedBtn" class="btn red" title="ì‚­ì œ"><i class="fas fa-trash"></i></button>
      </div>
    </div>

    <!-- ğŸ§¾ í…Œì´ë¸” -->
    <div class="table-container">
      <table>
        <thead>
        <tr>
          <th><input type="checkbox" id="checkAll" /></th>
          <th>No</th>
          <th>ì œëª©</th>
          <th>ë‹´ë‹¹ì</th>
          <th>ë“±ë¡ì¼</th>
          <th>ì„œë²„ ìƒíƒœ</th>
          <th>ê¸°ëŠ¥ ì˜µì…˜</th>
          <th>ë¹„ê³ </th>
        </tr>
        </thead>
        <tbody id="dataTable"></tbody>
      </table>
    </div>

    <!-- ğŸ“‘ í˜ì´ì§• -->
    <div id="pagination" class="pagination"></div>
  </div>

  <!-- â• ë“±ë¡ ëª¨ë‹¬ -->
  <div id="addModal" class="modal">
    <div class="elegant-modal">
      <div class="elegant-header">
        <h3>ì„œë²„ ë“±ë¡</h3>
        <span data-close="addModal" class="close-btn">&times;</span>
      </div>
      <div class="elegant-body">
        <div class="form-group"><label>ì œëª©</label><input id="titleInput" name="title" /></div>
        <div class="form-group"><label>ë‹´ë‹¹ì</label><input id="ownerInput" name="owner" /></div>
        <div class="form-group"><label>ì„œë²„ ìƒíƒœ</label>
          <select id="serverStatusInput" name="serverStatus">
            <option value="ì •ìƒ">ì •ìƒ</option>
            <option value="ì ê²€ì¤‘">ì ê²€ì¤‘</option>
          </select>
        </div>
        <div class="form-group"><label>ê¸°ëŠ¥ ì˜µì…˜</label>
          <div class="option-group">
            <label><input type="checkbox" name="featureOption" value="ë°±ì—… í™œì„±í™”"> ë°±ì—… í™œì„±í™”</label>
            <label><input type="checkbox" name="featureOption" value="ìë™ ëª¨ë‹ˆí„°ë§"> ìë™ ëª¨ë‹ˆí„°ë§</label>
          </div>
        </div>
        <div class="form-group"><label>ë“±ë¡ì¼</label><input type="date" id="regDateInput" name="regDate" /></div>
        <div class="form-group"><label>ë¹„ê³ </label><textarea id="remarkInput" name="remark" rows="3"></textarea></div>
      </div>
      <div class="modal-footer elegant-footer">
        <button id="saveBtn" class="btn">ì €ì¥</button>
        <button class="btn gray" data-close="addModal">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <!-- ğŸ§© ìƒì„¸ ëª¨ë‹¬ -->
  <div id="detailModal" class="modal">
    <div class="elegant-modal">
      <div class="elegant-header">
        <h3>ìƒì„¸ ì •ë³´</h3>
        <span data-close="detailModal" class="close-btn">&times;</span>
      </div>
      <div class="elegant-body">
        <div class="form-group"><label>No</label><input id="detailId" name="id" readonly /></div>
        <div class="form-group"><label>ì œëª©</label><input id="detailTitle" name="title" /></div>
        <div class="form-group"><label>ë‹´ë‹¹ì</label><input id="detailOwner" name="owner" /></div>
        <div class="form-group"><label>ë“±ë¡ì¼</label><input id="detailRegDate" name="regDate" readonly /></div>
        <div class="form-group"><label>ì„œë²„ ìƒíƒœ</label>
          <select id="detailServerStatus" name="serverStatus">
            <option value="ì •ìƒ">ì •ìƒ</option>
            <option value="ì ê²€ì¤‘">ì ê²€ì¤‘</option>
          </select>
        </div>
        <div class="form-group"><label>ê¸°ëŠ¥ ì˜µì…˜</label>
          <div class="option-group">
            <label><input type="checkbox" name="featureOption" value="ë°±ì—… í™œì„±í™”"> ë°±ì—… í™œì„±í™”</label>
            <label><input type="checkbox" name="featureOption" value="ìë™ ëª¨ë‹ˆí„°ë§"> ìë™ ëª¨ë‹ˆí„°ë§</label>
          </div>
        </div>
        <div class="form-group"><label>ë¹„ê³ </label><textarea id="detailRemark" name="remark" rows="3"></textarea></div>
      </div>
      <div class="modal-footer elegant-footer">
        <button id="updateBtn" class="btn">ìˆ˜ì •</button>
        <button class="btn gray" data-close="detailModal">ë‹«ê¸°</button>
      </div>
    </div>
  </div>
</div>

<!-- âœ… í˜ì´ì§€ ìŠ¤í¬ë¦½íŠ¸ -->
<th:block layout:fragment="pageScript">
<script>
document.addEventListener("DOMContentLoaded", () => {
  initUnifiedList({
    mode: "client", // server or client
    pagination: false,
    apiUrl: "/api/p01a05List",
    tableBodySelector: "#dataTable",
    paginationSelector: "#pagination",
    searchInputSelector: "#searchInput",
    searchBtnSelector: "#searchBtn",
    addBtnSelector: "#addBtn",
    modalId: "#addModal",
    saveBtnSelector: "#saveBtn",
    closeBtnSelector: "[data-close]",
    checkAllSelector: "#checkAll",
    deleteSelectedBtnSelector: "#deleteSelectedBtn",
    detailModalId: "#detailModal",
    updateBtnSelector: "#updateBtn",
    excelBtnSelector: "#excelBtn",

    excelFileName: "P01A05_ì„œë²„ë¦¬ìŠ¤íŠ¸.xlsx",
    
    columns: [
  	  // ì²´í¬ë°•ìŠ¤ ìˆëŠ” í…Œì´ë¸”{ checkbox: true } ì‚¬ìš©
  	  // ì²´í¬ë°•ìŠ¤ ì—†ëŠ” í…Œì´ë¸”checkbox ì»¬ëŸ¼ ìì²´ ì‚­ì œ
    	
    	  { key: "checkbox", label: "", checkbox: true }, 
      { key: "id", label: "No" },
      { key: "title", label: "ì œëª©", isDetailLink: true, required: true },
      { key: "owner", label: "ë‹´ë‹¹ì", isDetailLink: true, required: true },
      { key: "regDate", label: "ë“±ë¡ì¼" },
      { key: "serverStatus", label: "ì„œë²„ ìƒíƒœ" },
      { key: "featureOption", label: "ê¸°ëŠ¥ ì˜µì…˜" },
      { key: "remark", label: "ë¹„ê³ " }
    ],
    pageSize: 10,
    pageGroupSize: window.pageGroupSize, <!-- âœ… ì´ì œ ì „ì—­ë³€ìˆ˜ë¡œë¶€í„° ìë™ ì£¼ì… -->
    enableRowClickDetail: false,
    enableDetailView: true,
    buttons: {
      search: true,
      searchInput: true,
      add: true,
      deleteSelected: true,
      excel: true
    },
    detailViewButtons: {
      update: true,
      delete: false
    },
    onAddModalOpen: () => console.log("â• Add Modal Open"),
    onDetailModalOpen: (id) => console.log("ğŸ” Detail Modal Open:", id),
    onDeleteSuccess: (ids) => console.log("ğŸ—‘ï¸ Deleted:", ids)
  });

  const searchInput = document.getElementById("searchInput");
  const searchBtn = document.getElementById("searchBtn");
  searchInput.addEventListener("keydown", e => {
	  if (e.key === "Enter") searchBtn.click(); 
  });
  
  
  // âœ… 3. í˜ì´ì§€ë³„ ì»¤ìŠ¤í…€ ê¸°ëŠ¥ ì˜ˆì‹œ (ì›í•˜ë©´ í™•ì¥ ê°€ëŠ¥)
  const addUserBtn = document.getElementById("addUserBtn");
  if (addUserBtn) {
    addUserBtn.addEventListener("click", () => {
      alert("ğŸ‘¤ ì‚¬ìš©ì ì¶”ê°€ ëª¨ë‹¬ ì—¬ëŠ” ì»¤ìŠ¤í…€ ë¡œì§ ì‹¤í–‰");
    });
  }

  const customFilterBtn = document.getElementById("customFilterBtn");
  if (customFilterBtn) {
    customFilterBtn.addEventListener("click", () => {
      alert("ğŸ¯ ì»¤ìŠ¤í…€ í•„í„° ì‹¤í–‰");
      unifiedListManager.loadList(0, "web", "filter=active");
    });
  }
});
</script>
</th:block>

</body>
</html>
