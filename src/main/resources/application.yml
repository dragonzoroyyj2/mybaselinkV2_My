###########################################################################
# 🎯 어떤 환경을 기본으로 실행할지 결정 (집=home / 회사=company)
# - 기본은 'home'으로 실행되도록 함
# - 회사에서 실행 시: VM옵션에  -Dspring.profiles.active=company  지정
###########################################################################
spring:
  profiles:
    active: home



###########################################################################
# 🧩 [공통] Spring Boot 애플리케이션 설정 (집/회사 공통 적용)
# - 절대 'spring:' 키를 중복 선언하지 않음
###########################################################################
  #########################################################################
  # ✅ 애플리케이션 정보
  # - 모니터링/로그 등에 표시될 서비스명
  #########################################################################
  application:
    name: MyBaseLinkV2

  #########################################################################
  # ✅ UI 템플릿 엔진(Thymeleaf)
  # - HTML 렌더링 설정
  # - cache=false: 개발 중 변경사항 즉시 반영
  #########################################################################
  thymeleaf:
    prefix: classpath:/templates/      # 템플릿 기본 경로
    suffix: .html                      # 템플릿 확장자
    cache: false                       # 개발 중엔 false, 운영 전환 시 true 권장
    mode: HTML                         # HTML 모드
    encoding: UTF-8                    # 한글 깨짐 방지

  #########################################################################
  # ✅ JPA + Hibernate
  # - Entity ↔ DB 매핑 ORM 설정
  # - ddl-auto: none 이면 스키마 자동변경 안함(운영·안정성)
  #########################################################################
  jpa:
    hibernate:
      ddl-auto: update                   # ✔ 집에서 none로 동작 확인됨
    show-sql: false                    # SQL 콘솔 노출 끔(로그 폭주 방지)
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect  # PostgreSQL 방언
        default_schema: mybaselink       # 기본 스키마

  #########################################################################
  # ✅ DataSource (PostgreSQL 접속)
  # - 반드시 url/username/password 지정해야 연결됨
  # - driver-class-name은 명시적으로 지정
  #########################################################################
  datasource:
    driver-class-name: org.postgresql.Driver
    url: jdbc:postgresql://localhost:5432/mybaselink_db   # ✅ DB URL(집)
    username: mybaseuser                                   # ✅ DB 사용자(집)
    password: mybaseuser1234                               # ✅ DB 비밀번호(집)

    #######################################################################
    # ⚙ HikariCP 커넥션 풀 (성능 핵심)
    # - 아래 항목은 라인별 상세 설명 포함
    #######################################################################
    hikari:
      maximum-pool-size: 10          # 동시 DB 커넥션 최대 개수(기본 10; 트래픽↑이면 조정)
      minimum-idle: 2                # 유휴 상태에서도 유지할 커넥션 수(너무 낮으면 재생성 비용↑)
      connection-timeout: 30000      # 커넥션 대기 최대 시간(ms). 초과 시 SQLException 발생
      idle-timeout: 600000           # 사용 안 한 커넥션 정리 시간(ms) = 10분
      max-lifetime: 1800000          # 커넥션 최대 생존 시간(ms) = 30분(드라이버/DB 권장치와 맞춤)
      validation-timeout: 5000       # 커넥션 유효성 검사 최대 시간(ms). 길면 죽은 연결 방치 위험
      leak-detection-threshold: 0    # 0=비활성화. false-positive 경고 제거(진짜 의심 시 30000 등 사용)

  #########################################################################
  # ✅ 정적 리소스 제공 경로 (css/js/img 등)
  #########################################################################
  web:
    resources:
      static-locations: classpath:/static/,classpath:/public/,classpath:/resources/

  #########################################################################
  # ✅ 파일 업로드 (멀티파트)
  #########################################################################
  servlet:
    multipart:
      enabled: true
      max-file-size: 10MB            # 단일 파일 최대 크기
      max-request-size: 20MB         # 요청 전체 최대 크기

  #########################################################################
  # ✅ DevTools (개발 편의)
  # - 코드 저장 시 자동 재시작, 브라우저 라이브 리로드
  #########################################################################
  devtools:
    restart:
      enabled: true
    livereload:
      enabled: true



###########################################################################
# 🖥 서버 공통 설정
###########################################################################
server:
  port: 8080                           # 서비스 포트
  servlet:
    context-path: /                    # 기본 경로
  error:
    whitelabel:
      enabled: false                   # 기본 에러 페이지 비활성화



###########################################################################
# 🔐 JWT 토큰 설정
# - secret는 운영에서 더 강력한 난수로 교체 필수
# - expiration: 3600000ms = 1시간
###########################################################################
jwt:
  secret: MyNovaSecretKeyChangeThisToSomethingStrong123!
  expiration: 3600000
  #expiration: 305000



###########################################################################
# 🧠 로깅 레벨
# - Hibernate SQL 로그를 최소화
# - 애플리케이션 패키지는 DEBUG로 상세 추적
###########################################################################
logging:
  level:
    org.hibernate.SQL: ERROR
    org.hibernate.type.descriptor.sql.BasicBinder: ERROR
    com.mybaselink: DEBUG
    org.springframework: INFO
