-- mybaselink.users definition

-- Drop table

-- DROP TABLE mybaselink.users;

CREATE TABLE mybaselink.users (
	id bigserial NOT NULL,
	username varchar(50) NOT NULL,
	"password" varchar(255) NOT NULL,
	email varchar(100) NULL,
	full_name varchar(100) NULL,
	phone varchar(20) NULL,
	"role" varchar(50) DEFAULT 'USER'::character varying NULL,
	status varchar(10) DEFAULT 'active'::character varying NULL,
	last_login timestamptz NULL,
	created_at timestamptz DEFAULT now() NULL,
	updated_at timestamptz DEFAULT now() NULL,
	CONSTRAINT users_email_key UNIQUE (email),
	CONSTRAINT users_pkey PRIMARY KEY (id),
	CONSTRAINT users_username_key UNIQUE (username)
);


$2a$10$h3rLfhczAHiiKNGjMfYytO5snHTtwY3QlFUptOS0Upu6DYFhnBK/q

1	admin	$2a$10$h3rLfhczAHiiKNGjMfYytO5snHTtwY3QlFUptOS0Upu6DYFhnBK/q	admin@example.com	관리자	010-0000-0000	ADMIN	active		2025-10-11 16:35:53.467 +0900	2025-10-11 16:35:53.467 +0900
2	test	$2a$10$h3rLfhczAHiiKNGjMfYytO5snHTtwY3QlFUptOS0Upu6DYFhnBK/q	test@example.com	test	010-0000-0000	ADMIN	active		2025-10-11 16:35:53.467 +0900	2025-10-11 16:35:53.467 +0900

----------------------------------------------------------------


-- mybaselink.user_roles definition

-- Drop table

-- DROP TABLE mybaselink.user_roles;

CREATE TABLE mybaselink.user_roles (
	user_id int8 NOT NULL,
	role_id int8 NOT NULL,
	id int8 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 START 1 CACHE 1 NO CYCLE) NOT NULL,
	CONSTRAINT user_roles_pkey PRIMARY KEY (user_id, role_id)
);


-- mybaselink.user_roles foreign keys

ALTER TABLE mybaselink.user_roles ADD CONSTRAINT user_roles_role_id_fkey FOREIGN KEY (role_id) REFERENCES mybaselink.roles(id);
ALTER TABLE mybaselink.user_roles ADD CONSTRAINT user_roles_user_id_fkey FOREIGN KEY (user_id) REFERENCES mybaselink.users(id);


-----------------------------------------------

-- mybaselink.roles definition

-- Drop table

-- DROP TABLE mybaselink.roles;

CREATE TABLE mybaselink.roles (
	id bigserial NOT NULL,
	"name" varchar(50) NOT NULL,
	description text NULL,
	CONSTRAINT roles_name_key UNIQUE (name),
	CONSTRAINT roles_pkey PRIMARY KEY (id)
);

---------------------------------------


-- mybaselink.login_users definition

-- Drop table

-- DROP TABLE mybaselink.login_users;

CREATE TABLE mybaselink.login_users (
	id int8 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 START 1 CACHE 1 NO CYCLE) NOT NULL,
	email varchar(100) NULL,
	"name" varchar(50) NULL,
	"password" varchar(100) NOT NULL,
	"role" varchar(20) NOT NULL,
	username varchar(50) NOT NULL,
	CONSTRAINT login_users_pkey PRIMARY KEY (id),
	CONSTRAINT ukniit304xfekfcto33il61l7ok UNIQUE (username)
);

----------------------------------


-- mybaselink.jwt_tokens definition

-- Drop table

-- DROP TABLE mybaselink.jwt_tokens;

CREATE TABLE mybaselink.jwt_tokens (
	id bigserial NOT NULL,
	username varchar(255) NOT NULL,
	"token" varchar(512) NOT NULL,
	created_at timestamptz DEFAULT now() NULL,
	issued_at timestamptz NULL,
	expires_at timestamptz NULL,
	revoked bool DEFAULT false NULL,
	CONSTRAINT jwt_tokens_pkey PRIMARY KEY (id),
	CONSTRAINT jwt_tokens_token_key UNIQUE (token),
	CONSTRAINT unique_token UNIQUE (token)
);
CREATE INDEX idx_jwt_token_token ON mybaselink.jwt_tokens USING btree (token);
CREATE INDEX idx_jwt_token_username ON mybaselink.jwt_tokens USING btree (username);




----